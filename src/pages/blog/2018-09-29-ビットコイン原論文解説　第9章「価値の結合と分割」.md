---
templateKey: blog-post
title: ビットコイン原論文解説　第9章「価値の結合と分割」
date: 2018-09-29T14:32:44.379Z
description: ビットコイン原論文の第9章「価値の結合と分割」について分かりやすく解説します。
tags:
  - ビットコイン
  - 解説
---
![Bitcoin](/img/bitcoin-header.jpg)

## 目次

概要

第1章　イントロダクション

第2章　取引

第3章　タイムスタンプ・サーバー

第4章　Proof of Work

第5章　ネットワーク

第6章　インセンティブ

第7章　ディスク領域の再利用

第8章　簡易版支払い検証

**<font color="Green">第9章　価値の結合と分割</font>**

第10章　プライバシー

第11章　計算

第12章　結論

## 原文

> Although it would be possible to handle coins individually, it would be unwieldy to make a separate transaction for every cent in a transfer. To allow value to be split and combined, transactions contain multiple inputs and outputs. Normally there will be either a single input from a larger previous transaction or multiple inputs combining smaller amounts, and at most two outputs: one for the payment, and one returning the change, if any, back to the sender.

![Transaction](/img/bitcoin_utxo_pdf.png)

> It should be noted that fan-out, where a transaction depends on several transactions, and those transactions depend on many more, is not a problem here. There is never the need to extract a complete standalone copy of a transaction's history.

## 原文日本語訳

個別にコインを処理することは可能ですが、送金の1セントごとにトランザクションを分けるのは扱いにくいでしょう。値を分割したり結合したりできるように、トランザクションは複数のインプットとアウトプットを持ちます。通常、インプットには、以前のより大きなトランザクションからの単一なインプットと、少量を組み合わせた複数のインプットがあります。アウトプットは最大二つで、一つは支払い用のアウトプット、もう一つは（もしあれば）送金元に戻ってくるお釣り用のアウトプットです。

![Transaction](/img/bitcoin_utxo_pdf.png)

特筆すべきは、トランザクションが複数のトランザクションに依存し、また依存元のトランザクションもさらに多数のトランザクションに依存しているというファンアウトは問題にならないという点です。トランザクション履歴の完全なスタンドアロンコピーを抽出する必要は一切ありません。

## 解説

### まとめ

* トランザクションには複数のインプットとアウトプットが含まれる。
* インプットは、以前のより大きなトランザクションであれば一つ、より小さなトランザクションであれば複数になる。
* アウトプットは、送金用が一つ、お釣りがあればお釣り用が一つの、最大二つである。
* トランザクションはインプットとアウトプットによって連鎖しているが、その連鎖構造を解明しなくても問題にはならない。

### 詳しい解説

本章では、第二章「取引」と関連して、トランザクションの内部構造について述べられています。

ビットコインには、私たちが普段利用する銀行のような「残高」や「口座」といった仕組みを持ちません。全ては、貸借対照表のようにインプットとアウトプットのフローの概念で処理されています。

#### Bobのコーヒーショップ

具体例がないとわかりづらいので、コーヒーショップの事例で考えてみましょう。

![](/img/transaction.png)

Bobはシリコンバレーで有機栽培のコーヒーにこだわったコーヒーショップを経営しています。エンジニアから独立した新進気鋭な精神の持ち主で、現金の非効率性やクレジットカードの手数料が嫌いです。そのためBobのコーヒーショップではビットコインでしか支払いを受け付けていません。

近頃Bobのコーヒーショップの近所に引っ越してきたAliceは連日行列を作っているBobの店が気になってしかたありません。しかしながらAliceはビットコインを持っていませんでした。

Aliceの会社の同僚であるZackはビットコインマイナーでたくさんのビットコインを持っています。AliceはZackに頼んでビットコインを1BTC分だけ譲ってもらいました。

アリスは1BTCを受け取ったので、Bobの店に向かいます。Bobの店ではコーヒーが0.1BTCで売られています。Aliceはレジで商品を受け取り、Bobの店のアドレスに0.1BTCを送金します。この時、インプットにZackからの1BTCが利用され、お釣りとして発生した0.9BTCはAlice自身のアドレスに送金されます。

Aliceは無事に美味しいコーヒーを堪能できました。

その晩、Bobは友人に紹介してもらったグラフィックデザイナーのChrisから依頼していたショップカードが仕上がったと連絡を受けました。メールに添付された画像のデザインに満足し、BobはChrisに報酬の0.45BTCを支払います。この時、インプットには初来店のAliceが支払った0.1BTCと、常連客のYannが支払った0.4BTCが当てられ、お釣りである0.05BTCはBobのアドレスに送金されます。

##### Note

上記の例ではわかりやすさのため、マイナーへの手数料を省略しています。実際にはマイナー手数料を上乗せした金額をINPUTに用意する必要があります。

#### トランザクションの依存関係

このように、トランザクションはインプットとアウトプットが常に対称です。インプットが用意できるということは、その以前のトランザクションでアウトプットとしてビットコインを得ているということです。トランザクションは過去へ過去へと遡ることができ、最終的には起源であるGenesisブロックまでたどり着きます。

この時、一つのトランザクションごとに、Genesisブロックまで繋がる過去のトランザクションをまとめて独立したコピーを作るのは大変非効率です。

そもそも、トランザクションがブロックに取り込まれる時にノードによって検証が行われており、過去のトランザクションであるほど高い信頼性を持っています。そのため、新規のトランザクションに対しては構造が仕様通りであるか、また、二重支払いとなっていないかが検証されれば、ブロックに入れることが出来ます。

<hr>
＜　前章: 第8章　簡易版支払い検証

　　次章: 第10章　プライバシー　＞
